{% extends "library/base.html" %}
{% block title %}Admin Home{% endblock %}
{% block content %}

<h2>Admin Dashboard</h2>

<!-- Stats -->
<div class="row mb-3">
  <div class="col-auto">
    <div class="border p-3">
      <strong>Books:</strong> {{ books_count }}
    </div>
  </div>
  <div class="col-auto">
    <div class="border p-3">
      <strong>Currently issued:</strong> {{ issued_count }}
    </div>
  </div>
</div>

<!-- Recent Transactions -->
<h4>Recent transactions</h4>
<table class="table table-sm">
  <thead><tr><th>Book</th><th>User</th><th>Issue date</th><th>Due</th><th>Status</th><th>Action</th></tr></thead>
  <tbody>
    {% for t in recent_tx %}
      <tr>
        <td>{{ t.book.title }}</td>
        <td>{{ t.user.username }}</td>
        <td>{{ t.issue_date }}</td>
        <td>{{ t.due_date }}</td>
        <td>{{ t.status }}</td>
        <td>
          {% if t.status == 'issued' %}
            <a class="btn btn-sm btn-warning" href="{% url 'return_book' t.id %}">Return</a>
          {% endif %}
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="6">No transactions yet.</td></tr>
    {% endfor %}
  </tbody>
</table>

<!-- New Sections: Maintenance, Reports, Transactions -->
<div class="row mt-4">
  <!-- Maintenance -->
  <div class="col-md-4 mb-3">
    <h4>Maintenance</h4>
    <ul class="list-group">
      <li class="list-group-item"><a href="{% url 'membership_list' %}">Manage Memberships</a></li>
      <li class="list-group-item"><a href="{% url 'book_list' %}">Manage Books</a></li>
      <li class="list-group-item"><a href="{% url 'user_list' %}">Manage Users</a></li>
    </ul>
  </div>

  <!-- Reports -->
  <div class="col-md-4 mb-3">
    <h4>Reports</h4>
    <ul class="list-group">
      <li class="list-group-item"><a href="{% url 'pending_issues' %}">Pending Issue Requests</a></li>
      <li class="list-group-item"><a href="{% url 'overdue_returns' %}">Overdue Returns</a></li>
      <li class="list-group-item"><a href="{% url 'active_issues' %}">Active Issues</a></li>
      <li class="list-group-item"><a href="{% url 'membership_master_list' %}">Master List of Memberships</a></li>
      <li class="list-group-item"><a href="{% url 'book_master_list' %}">Master List of Books</a></li>
    </ul>
  </div>

  <!-- Transactions -->
  <div class="col-md-4 mb-3">
    <h4>Transactions</h4>
    <ul class="list-group">
      <li class="list-group-item"><a href="{% url 'book_availability' %}">Check Book Availability / Search</a></li>
      <li class="list-group-item"><a href="{% url 'issue_book' %}">Issue Book</a></li>
      <li class="list-group-item"><a href="{% url 'return_book_list' %}">Return Book</a></li>
    </ul>
  </div>
</div>

{% endblock %}
